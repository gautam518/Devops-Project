What is malware?

Malware is a piece of software which causes harm to a computer system without the owner’s consent. Viruses, Trojans, worms, backdoors, rootkits and spyware can all be considered as malwares.
With new malware attacks making news every day and compromising company’s network and critical infrastructures around the world, malware analysis is critical for anyone who responds to such incidents.

Types of Malware Analysis
Static Analysis
Dynamic Analysis
Memory Analysis

Static Analysis
Static Analysis involves analyzing the malware without actually executing it. Following are the steps: 

1-Determining the File Type: Determining the file type can also help you understand the type of environment the malware is targeted towards, for example if the file type is ELF (Executable and Linkable format) format which is a standard binary file format for Unix and Unix-like systems, then it can be concluded that the malware is targeted towards a Unix or Unix flavoured systems

2-Determining the Cryptographic Hash: Cryptographic Hash values like MD5 and SHA1 can serve as a unique identifier for the file throughout the course of analysis. Malware, after executing can copy itself to a different location or drop another piece of malware, cryptographic hash can help you determine whether the newly copied/dropped sample is same as the original sample or a different one. With this information we can determine if malware analysis needs to be performed on a single sample or multiple samples. Cryptographic hash can also be submitted to online antivirus scanners like VirusTotal to determine if it has been previously detected by any of the AV vendors. Cryptographic hash can also be used to search for the specific malware sample on the internet. 

3-Strings search: Strings are plain text ASCII and UNICODE characters embedded within a file. Strings search give clues about the functionality and commands associated with a malicious file. Although strings do not provide complete picture of the function and capability of a file, they can yield information like file names, URL, domain names, ip address, attack commands etc. 

4-File obfuscation (packers, cryptors) detection: Malware authors often use softwares like packers and cryptors to obfuscate the contents of the file in order to evade detection from anti-virus softwares and intrustion detection systems. This technique slows down the malware analysts from reverse engineering the code. 

5-Determine Fuzzy Hash: Comparing the malware samples collected or maintained in a private or public repository is an important part of file identification process. The easiest way to check for file similarity is through a process called “Fuzzy Hashing”. Fuzzy hash comparison can tell the percentage similarity between the files. Fuzzy hash comparison is a method by which identical files can be identified. This can help in determine the variants of the same malware. 
Submission to online Antivirus scanning services: This will help you determine if the malicious code signatures exist for the suspect file. The signature name for the specific file provides an excellent way to gain additional information about the file and capabilities. By visiting the respective antivirus vendor web sites or searching for the signature in search engines can yield additional details about the suspect file. Such information may help in further investigation and reduce the analysis time of the malware specimen. VirusTotal (http://www.virustotal.com) is a popular web based malware scanning services.
Inspecting File Dependencies: Executable loads multiple shared libraries and call api functions to perform certain actions like resolving domain names, establishing an http connection etc. Determining the type of shared library and list of api calls imported by an executable can give an idea on the functionality of the malware. 
6-Examining ELF File Structure: ELF stands for “Executable and Linkable Format” this is a standard binary file format for Linux systems. Examining the ELF file structure can yield wealth of the information including Sections, Symbols and other file metadata information. 
Disassembling the File: Examining the suspect program in a disassembler allows the investigator to explore the instructions that will be executed by the malware. Disassembly can help in tracing the paths that are not usually determined during dynamic analysis.


Dynamic Analysis

Dynamic Analysis involves executing the malware sample in a controlled environment and monitoring as it runs. Sometimes static analysis will not reveal much information due to obfuscation, packing in such cases dynamic analysis is the best way to identify malware functionality. Following are some of the steps involved in dynamic analysis: 

1-Monitoring Process Activity: This involves executing the malicious program and examining the properties of the resulting process and other processes running on the infected system. This technique can reveal information about the process like process name, process id, child processes created, system path of the executable program, modules loaded by the suspect program. 
2-Monitoring File System Activity: This involves examining the real time file system activity while the malware is running; this technique reveals information about the opened files, newly created files and deleted files as a result of executing the malware sample. 
3-Monitoring Network Activity: In addition to monitoring the activity on the infected host system, monitoring the network traffic to and from the system during the course of running the malware sample is also important. This helps to identify the network capabilities of the specimen and will also allow us to determine the network based indicator which can then be used to create signatures on security devices like Intrusion Detection System 
4-System Call Tracing: System calls made by malware can provide insight into the nature and purpose of the executed program such as file, network and memory access. Monitoring the system calls can help determine the interaction of the malware with the operating system.

Memory Analysis

Memory Analysis also referred to as Memory Forensics is the analysis of the memory image taken from the running computer. Analyzing the memory after executing the malware sample provides post-mortem perspective and helps in extracting forensics artifacts from a computer’s memory like:

running processes
network connections
shared libraries
loaded kernel modules
code injections
Rootkit capabilities.
API Hooking

Types of malware
1- virus
It is the type of malwrae that infects other files.

2-Worms:
It is a type of malware that spreads copy of itself from computer to computer.A worm can replicate itself without any human intractions.

Worms can be transmitted via software vulnerabilities. Or computer worms could arrive as attachments in spam emails or instant messages (IMs). Once opened, these files could provide a link to a malicious website or automatically download the computer worm. Once it’s installed, the worm silently goes to work and infects the machine without the user’s knowledge.

Worms can modify and delete files, and they can even inject additional malicious software onto a computer. Sometimes a computer worm’s purpose is only to make copies of itself over and over — depleting system resources, such as hard drive space or bandwidth, by overloading a shared network.

How to tell if your computer has a worm

1-Keep an eye on your hard drive space. When worms repeatedly replicate themselves, they start to use up the free space on your computer.
2-Monitor speed and performance. Has your computer seemed a little sluggish lately? Are some of your programs crashing or not running properly? That could be a red flag that a worm is eating up your processing power.
3-Be on the lookout for missing or new files. One function of a computer worm is to delete and replace files on a computer.

How to help protect against computer worms 
1-Since software vulnerabilities are major infection vectors for computer worms, be sure your computer’s operating system and applications are up to date with the latest versions. Install these updates as soon as they’re available because updates often include patches for security flaws.
2-Phishing is another popular way for hackers to spread worms (and other types of malware). Always be extra cautious when opening unsolicited emails, especially those from unknown senders that contain attachments or dubious links. 
3-Be sure to invest in a strong internet security software solution that can help block these threats. A good product should have anti-phishing technology as well as defenses against viruses, spyware, ransomware, and other online threats.

3-Trojans
A Trojan horse, or Trojan, is a type of malicious code or software that looks legitimate but can take control of your computer. A Trojan is designed to damage, disrupt, steal, or in general inflict some other harmful action on your data or network.

How do Trojans work?
you’ve received an email from someone you know and click on what looks like a legitimate attachment. But you’ve been fooled. The email is from a cybercriminal, and the file you clicked on — and downloaded and opened — has gone on to install malware on your device.

When you execute the program, the malware can spread to other files and damage your computer.
Common types of Trojan malware, from A to Z

Backdoor Trojan
Backdoor Trojan

This Trojan can create a “backdoor” on your computer. It lets an attacker access your computer and control it. Your data can be downloaded by a third party and stolen. Or more malware can be uploaded to your device.

Distributed Denial of Service (DDoS) attack Trojan

This Trojan performs DDoS attacks. The idea is to take down a network by flooding it with traffic. That traffic comes from your infected computer and others.

Downloader Trojan

This Trojan targets your already-infected computer. It downloads and installs new versions of malicious programs. These can include Trojans and adware.

Fake AV Trojan

This Trojan behaves like antivirus software, but demands money from you to detect and remove threats, whether they’re real or fake.

Game-thief Trojan

The losers here may be online gamers. This Trojan seeks to steal their account information.

Infostealer Trojan

As it sounds, this Trojan is after data on your infected computer.

Mailfinder Trojan

This Trojan seeks to steal the email addresses you’ve accumulated on your device.

Ransom Trojan

This Trojan seeks a ransom to undo damage it has done to your computer. This can include blocking your data or impairing your computer’s performance.

Remote Access Trojan

This Trojan can give an attacker full control over your computer via a remote network connection. Its uses include stealing your information or spying on you.

Rootkit Trojan

A rootkit aims to hide or obscure an object on your infected computer. The idea? To extend the time a malicious program runs on your device.

How to help protect against Trojans
Here are some dos and don’ts to help protect against Trojan malware. First, the dos:

Computer security begins with installing and running an internet security suite. Run periodic diagnostic scans with your software. You can set it up so the program runs scans automatically during regular intervals.
Update your operating system’s software as soon as updates are made available from the software company. Cybercriminals tend to exploit security holes in outdated software programs. In addition to operating system updates, you should also check for updates on other software that you use on your computer.
Protect your accounts with complex, unique passwords. Create a unique password for each account using a complex combination of letters, numbers, and symbols.
Keep your personal information safe with firewalls.
Back up your files regularly. If a Trojan infects your computer, this will help you to restore your data.
Be careful with email attachments. To help stay safe, scan an email attachment first. 
A lot of things you should do come with a corresponding thing not to do — like, do be careful with email attachments and don’t click on suspicious email attachments. Here are some more don’ts.

Don’t visit unsafe websites. Some internet security software will alert you that you’re about to visit an unsafe site, such as Norton Safe Web.
Don’t open a link in an email unless you’re confident it comes from a legitimate source. In general, avoid opening unsolicited emails from senders you don’t know.
Don’t download or install programs if you don’t have complete trust in the publisher.

4-Ransomware
Ransomware is a form of malware that encrypts a victim's files. The attacker then demands a ransom from the victim to restore access to the data upon payment. 

How ransomware works
There are a number of vectors ransomware can take to access a computer. One of the most common delivery systems is phishing spam — attachments that come to the victim in an email, masquerading as a file they should trust. Once they're downloaded and opened, they can take over the victim's computer, especially if they have built-in social engineering tools that trick users into allowing administrative access. Some other, more aggressive forms of ransomware, like NotPetya, exploit security holes to infect computers without needing to trick users.

How to prevent ransomware
eep your operating system patched and up-to-date to ensure you have fewer vulnerabilities to exploit.
Don't install software or give it administrative privileges unless you know exactly what it is and what it does.
Install antivirus software, which detects malicious programs like ransomware as they arrive, and whitelisting software, which prevents unauthorized applications from executing in the first place.
And, of course, back up your files, frequently and automatically! That won't stop a malware attack, but it can make the damage caused by one much less significant.

The following is a partial list of known Linux malware
Botnets
1-Mayhem – 32/64-bit Linux/FreeBSD multifunctional botnet[35]
2-Linux.Remaiten – a threat targeting the Internet of things.[36][37][38]
3-Mirai (malware) – a DDoS botnet spreads through telnet service and designed to infect Internet of Things (IoT).[39][40][41][42][43]
4-GafGyt/BASHLITE/Qbot – a DDoS botnet spreads through SSH and Telnet service weak passwords, firstly discovered during bash Shellshock vulnerability.[44]
5-LuaBot – a botnet coded with modules component in Lua programming language, cross-compiled in C wrapper with LibC, it aims for Internet of Things in ARM, MIPS and PPC architectures, with the usage to DDoS, spreads Mirai (malware) or selling proxy access to the cyber crime.[45][46]
6-Hydra,[47] Aidra,[48] LightAidra[49] and NewAidra[50] – another form of a powerful IRC botnet that infects Linux boxes.
7-EnergyMech 2.8 overkill mod (Linux/Overkill) – a long last botnet designed to infect servers with its bot and operated through IRC protocol for the DDoS and spreading purpose.[51]

Ransomware
Linux.Encoder.1

Rootkits
Snakso – a 64-bit Linux webserver rootkit

Trojans
Effusion – 32/64-bit injector for Apache/Nginx webservers, (7 Jan 2014)[57]
Hand of Thief – Banking trojan, 2013,[58][59]
Kaiten – Linux.Backdoor.Kaiten trojan horse[60]
Rexob – Linux.Backdoor.Rexob trojan[61]
Waterfall screensaver backdoor – on gnome-look.org[62]
Tsunami.gen – Backdoor.Linux.Tsunami.gen[63]
Turla – HEUR:Backdoor.Linux.Turla.gen[64][65]
Xor DDoS[66] – a trojan malware that hijacks Linux systems and uses them to launch DDoS attacks which have reached loads of 150+ Gbps.[67]
Hummingbad – has infected over 10 million Android operating systems. User details are sold and adverts are tapped on without the user's knowledge thereby generating fraudulent advertising revenue.[68]
NyaDrop – a small Linux backdoor compiled from a Linux shellcode to be used to infect Linux boxes with bigger size Linux malware.[69]
PNScan – Linux trojan designed to aim routers and self-infecting to a specific targeted network segment in a worm-like form[70]
SpeakUp – a backdoor trojan that infects six different Linux distributions and macOS devices.[71][72]

Viruses
42[73][74]
Arches[75]
Alaeda – Virus.Linux.Alaeda[76]
Binom – Linux/Binom[77]
Bliss – requires root privileges
Brundle[78]
Bukowski[79]
Caveat [80][81]
Cephei – Linux.Cephei.A (and variants)[82]
Coin [83][84]
Hasher [85][86]
Lacrimae (aka Crimea) [87][88]
MetaPHOR (also known as Simile)[89]
Nuxbee – Virus.Linux.Nuxbee.1403[90]
OSF.8759
PiLoT[91][92]
Podloso – Linux.Podloso (The iPod virus)[93][94]
RELx [95]
Rike – Virus.Linux.Rike.1627[96]
RST – Virus.Linux.RST.a[97] (known for infecting Korean release of Mozilla Suite 1.7.6 and Thunderbird 1.0.2 in September 2005[98])
Staog
Vit – Virus.Linux.Vit.4096[99]
Winter – Virus.Linux.Winter.341[100]
Winux (also known as Lindose and PEElf)[101]
Wit virus[102]
Zariche – Linux.Zariche.A (and variants)[103]
ZipWorm – Virus.Linux.ZipWorm[104]

Worms
Adm – Net-Worm.Linux.Adm[105]
Adore[106]
Bad Bunny – Perl.Badbunny[8][107]
Cheese – Net-Worm.Linux.Cheese[108]
Devnull
Kork[109]
Linux/Lion
Linux.Darlloz – targets home routers, set-top boxes, security cameras and industrial control systems.[110][111]
Linux/Lupper.worm[112]
Mighty – Net-Worm.Linux.Mighty[113]
Millen – Linux.Millen.Worm[114]
Ramen worm - targeted only Red Hat Linux distributions versions 6.2 and 7.0
Slapper[115]
SSH Bruteforce[116]

These applications look for actual threats to the Linux computers on which they are running.

chkrootkit (free and open source software)
ClamAV (free and open source software)
Comodo (proprietary) 
Dr.Web (proprietary) 
ESET (proprietary) (detects OS X, Windows malware as well)
Linux Malware Detect
lynis (open source auditing) 
rkhunter (free and open source software)
Sophos (proprietary) (versions for UNIX and Windows too)
Linux malware can also be detected (and analyzed) using memory forensics tools, such as:

Forcepoint (proprietary)
Volatility (free and open source software)







